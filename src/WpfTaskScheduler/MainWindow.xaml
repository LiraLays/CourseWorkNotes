<Window x:Class="WpfTaskScheduler.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WpfTaskScheduler.ViewModels"
        mc:Ignorable="d"
        MinWidth="1200"
        MinHeight="800"
        Title="Планировщик" 
        Background="Black"
        WindowState="Maximized"
        WindowStyle="SingleBorderWindow"
        ResizeMode="CanResizeWithGrip"
        Topmost="True"
        Icon="/icon-notepad.png">
    <Window.Resources>
        <!--<local:StringToVisibilityConverter x:Key="StringToVisibilityConverter" /> -->
        <local:PriorityConverter x:Key="PriorityConverter" />
    </Window.Resources>
    <TabControl x:Name="tabControl"
                Style="{StaticResource GlowingTabControlStyle}"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Margin="0">
        <TabControl.Resources>
            <Style TargetType="TabItem" BasedOn="{StaticResource GlowingTabItemStyle}"/>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        </TabControl.Resources>
        <TabItem Header="Планировщик Задач" FontFamily="Cascadia Code" FontSize="24">
            <ScrollViewer
                Style="{StaticResource GlowingScrollViewerStyle}">
            <Grid Margin="0,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Левая часть - список задач -->
                <GroupBox Header="Все задачи"
                          Style="{StaticResource GlowingGroupBoxStyle}"
                          Margin="5">
                    <DataGrid x:Name="tasksDataGrid"
                              ItemsSource="{Binding AllTasksView}"
                              SelectedItem="{Binding SelectedTask}"
                              Style="{StaticResource GlowingDataGridStyle}"
                              HorizontalScrollBarVisibility="Disabled"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserSortColumns="True"
                              >
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Название"
                                                Binding="{Binding Title}"
                                                Width="*" 
                                                />
                            <DataGridTextColumn Header="Дедлайн"
                                                Binding="{Binding Deadline, StringFormat=dd.MM.yyyy}"
                                                Width="120"
                                                IsReadOnly="True" />
                                <DataGridTemplateColumn Header="Приоритет"
                                                        Width="150"
                                                        >
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Priority, Converter={StaticResource PriorityConverter}}"
                                                       Style="{StaticResource GlowingTextBlockStyle}"
                                                       VerticalAlignment="Center"
                                                       FontSize="14" />
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridCheckBoxColumn Header="Выполнена"
                                                    Binding="{Binding IsCompleted}"
                                                    Width="100"
                                                    SortDirection="Descending"
                                                    SortMemberPath="IsCompleted"
                                                    IsReadOnly="True"/>
                            <DataGridTemplateColumn Header="Действия"
                                                    Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Выполнить"
                                                Command="{Binding DataContext.MarkAsCompletedCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                CommandParameter="{Binding}"
                                                Style="{StaticResource GlowButtonStyle}"
                                                FontSize="10"
                                                Padding="5,2" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                        
                        
                    </DataGrid>
                </GroupBox>

                <!-- Правая часть - управление -->
                <StackPanel Grid.Column="1"
                            Width="600"
                            Margin="5">
                    <!-- Добавление новой задачи -->
                    <GroupBox Header="Новая задача"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,10">
                        <StackPanel>
                                <TextBlock Text="Название задачи:"
                                           Style="{StaticResource GlowingTextBlockStyle}"
                                           Margin="5" />
                                <TextBox Text="{Binding NewTaskTitle, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource GlowingTextBoxStyle}"
                                     Margin="5"
                                     FontSize="24"
                                     Height="40"
                                     VerticalContentAlignment="Center" />
                                <TextBlock Text="Дата:"
                                           Style="{StaticResource GlowingTextBlockStyle}"
                                           Margin="5" />
                                <DatePicker SelectedDate="{Binding NewTaskDeadline}"
                                        Margin="5"
                                        FontSize="20"
                                        Height="30" />
                                <TextBlock Text="Приоритет:"
                                           Style="{StaticResource GlowingTextBlockStyle}"
                                           Margin="5" />
                                <ComboBox ItemsSource="{Binding PriorityOptions}"
                                          SelectedValue="{Binding NewTaskPriority}"
                                          SelectedValuePath="Value"
                                          Style="{StaticResource GlowingComboBoxStyle}"
                                          Margin="5"
                                          FontSize="16"
                                          Height="40">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DisplayName}"
                                                       Style="{StaticResource GlowingTextBlockStyle}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <Button Content="Добавить Задачу"
                                    Command="{Binding AddNewTaskCommand}"
                                    Style="{StaticResource GlowButtonStyle}"
                                    Margin="5"
                                    Height="40" />
                            <Button Content="Быстрая задача"
                                    Command="{Binding AddQuickTaskCommand}"
                                    Style="{StaticResource GlowButtonStyle}"
                                    Margin="5"
                                    Height="40" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Фильтрация -->
                    <GroupBox x:Name="groupBox"
                              Header="Фильтры"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,10">
                        <StackPanel>
                                <CheckBox Content="По Дедлайну"
                                          IsChecked="{Binding FilterByDeadline}"
                                          Style="{StaticResource GlowingCheckBoxStyle}"
                                          Margin="5" />
                                <TextBox Text="{Binding DeadlineFilter, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource GlowingTextBoxStyle}"
                                         Margin="5"
                                         FontSize="14"
                                         Height="40"
                                         VerticalContentAlignment="Center"
                                         Visibility="{Binding FilterByDeadline, Converter={StaticResource BooleanToVisibilityConverter}}"
                                         ToolTip="Введите условие для дедлайна (например: &gt; сегодня)" />

                                <!-- Фильтр по приоритету -->
                                <CheckBox Content="По Приоритету"
                                          IsChecked="{Binding FilterByPriority}"
                                          Style="{StaticResource GlowingCheckBoxStyle}"
                                          Margin="5" />
                                <ComboBox ItemsSource="{Binding PriorityFilterOptions}"
                                          SelectedValue="{Binding PriorityFilter}"
                                          SelectedValuePath="Value"
                                          Style="{StaticResource GlowingComboBoxStyle}"
                                          Margin="5"
                                          FontSize="14"
                                          Height="40"
                                          VerticalContentAlignment="Center"
                                          Visibility="{Binding FilterByPriority, Converter={StaticResource BooleanToVisibilityConverter}}"
                                          ToolTip="Выберите приоритет для фильтрации">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DisplayName}"
                                                       Style="{StaticResource GlowingTextBlockStyle}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                    </GroupBox>

                        <!-- Сообщения системы -->
                        <Border Style="{StaticResource GlowingBorderStyleWrong}"
                                Visibility="{Binding IsErrorMessage, Converter={StaticResource BooleanToVisibilityConverter}}"
                                Margin="0">
                            <TextBlock Text="{Binding ErrorMessage}"
                                       Style="{StaticResource GlowingTextBlockStyleWrong}"
                                       Margin="10,5"
                                       TextWrapping="Wrap" />
                        </Border>

                        <Border Style="{StaticResource GlowingBorderStyleCorrect}"
                                Visibility="{Binding IsSuccessMessage, Converter={StaticResource BooleanToVisibilityConverter}}"
                                Margin="0">
                            <TextBlock Text="{Binding ErrorMessage}"
                                       Style="{StaticResource GlowingTextBlockStyleCorrect}"
                                       Margin="10,5"
                                       TextWrapping="Wrap" />
                        </Border>
                    </StackPanel>
            </Grid>
            </ScrollViewer>
        </TabItem>
        <TabItem Header="Верификация"
                 FontSize="24">
            <Grid>
                <GroupBox Header="Верификация"
                          Style="{StaticResource GlowingGroupBoxStyle}">
                    <StackPanel>
                        <Button Content="Показать детали"
                                Command="{Binding ShowVerificationDetailsCommand}"
                                Style="{StaticResource GlowButtonStyle}"
                                Margin="5"
                                Height="30" />
                        <Button Content="Очистить"
                                Command="{Binding ClearVerificationCommand}"
                                Style="{StaticResource GlowButtonStyle}"
                                Margin="5"
                                Height="30" />
                        <TextBox Text="{Binding VerificationLog}"
                                 Style="{StaticResource GlowingTextBoxStyle}"
                                 Margin="5"
                                 FontSize="20"
                                 Height="Auto"
                                 TextWrapping="Wrap"
                                 IsReadOnly="True"
                                 VerticalScrollBarVisibility="Auto" />
                        <TextBlock Text="Шаги расчета WP:"
                                   Style="{StaticResource GlowingTextBlockStyle}"
                                   Margin="5"
                                   FontSize="20"
                                   Height="Auto"
                                   />
                        <ListBox ItemsSource="{Binding VerificationSteps}"
                                 Style="{StaticResource GlowingListBoxStyle}"
                                 Margin="5"
                                 Height="Auto" 
                                 FontSize="20"
                                 />
                    </StackPanel>
                </GroupBox>
            </Grid>
        </TabItem>
        <TabItem Header="Справка" FontSize="24">
            <ScrollViewer Style="{StaticResource GlowingScrollViewerStyle}">
                <StackPanel Margin="20">
                    <!-- Заголовок -->
                    <TextBlock Text="Справка по планировщику задач"
                               Style="{StaticResource GlowingTextBlockStyle}"
                               FontSize="32"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,20" />

                    <!-- Основные функции -->
                    <GroupBox Header="📋 Основные функции"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="• Создание и управление задачами с приоритетами"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Автоматическое сохранение данных между запусками"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Фильтрация и сортировка задач"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Верификация операций с задачами"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Создание задач -->
                    <GroupBox Header="➕ Создание задач"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="• Название: обязательное поле"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Дедлайн: должен быть в будущем"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Приоритет: от 1 (Не срочно) до 4 (Крайне срочно)"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Быстрая задача: автоматически создает задачу с тестовыми данными"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Фильтрация -->
                    <GroupBox Header="🔍 Фильтрация задач"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="По дедлайну:"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       FontWeight="Bold"
                                       Margin="5,10,5,5" />
                            <TextBlock Text="• &gt; сегодня - задачи после сегодняшней даты"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• &lt; сегодня - задачи до сегодняшней даты"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• == сегодня - задачи на сегодня"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• ДД.ММ.ГГГГ - конкретная дата"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />

                            <TextBlock Text="По приоритету:"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       FontWeight="Bold"
                                       Margin="5,10,5,5" />
                            <TextBlock Text="• 1 - Не срочно"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• 2 - Умеренно"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• 3 - Срочно"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• 4 - Крайне срочно"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Управление задачами -->
                    <GroupBox Header="⚙️ Управление задачами"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="• Отметка выполнения: кнопка 'Выполнить' в списке задач"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Автосортировка: по статусу выполнения и дедлайну"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Данные сохраняются автоматически в файл tasks.txt"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Верификация -->
                    <GroupBox Header="🔬 Верификация операций"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="Функция демонстрирует формальную верификацию операций:"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Булевы функции (Лабораторная 4)"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                            <TextBlock Text="• Инварианты циклов (Лабораторная 3)"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                            <TextBlock Text="• WP-расчеты (Лабораторная 2)"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                            <TextBlock Text="Нажмите 'Показать детали' для просмотра шагов верификации"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,10,5,5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Сообщения -->
                    <GroupBox Header="💡 Сообщения системы"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="• Ошибки отображаются в красной рамке"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Успешные операции - в зеленом тексте"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Проверяйте сообщения для понимания состояния операций"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Техническая информация -->
                    <GroupBox Header="🔧 Техническая информация"
                              Style="{StaticResource GlowingGroupBoxStyle}"
                              Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="• Данные сохраняются в файл tasks.txt в папке приложения"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Формат хранения: каждая задача в отдельной строке"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Поддерживается работа с большим количеством задач"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Автоматическое резервное копирование не предусмотрено"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                        </StackPanel>
                    </GroupBox>

                    <!-- Контакты -->
                    <GroupBox Header="📞 Поддержка"
                              Style="{StaticResource GlowingGroupBoxStyle}">
                        <StackPanel>
                            <TextBlock Text="Для отчетности по лабораторным работам:"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5" />
                            <TextBlock Text="• Лаб. 1: Планировщик задач"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                            <TextBlock Text="• Лаб. 2: Калькулятор Weakest Precondition"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                            <TextBlock Text="• Лаб. 3: Верификация циклов с инвариантами"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                            <TextBlock Text="• Лаб. 4: Калькулятор логических функций"
                                       Style="{StaticResource GlowingTextBlockStyle}"
                                       Margin="5,2,5,2" />
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </ScrollViewer>
        </TabItem>
    </TabControl>
</Window>